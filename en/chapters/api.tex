\chapter{Using the C API and Bindings}

\label{chap:api}
\index{API|(} \index{API!calls|see{Calls}}

\chquote{He cleaned in one day the ox dung of King Augeas,\\
Jove helping him for the most part.\\
By letting in a river\\
he washed away all the dung.}{Fabula 30}{Hyginus}

So far, our examples have been done using \verb!augtool!, the CLI interface to Augeas. However, Augeas is first and foremost a C library.

\todo{Define a proper way of presenting the API. Maybe give simple examples instead of making it a reference.}

\todo{Given sample codes for each language}


\section{Using the C API}

\index{API!C API}

\todo{See what example could be nice to do with the C API...}

\section{API Flags}

\index{Flags} \index{API!flags|see{Flags}}

\section{Using Bindings}

\index{API!bindings|(}

\subsection{Haskell bindings}

\index{API!bindings!Haskell}

\subsection{Java bindings}

\todo{Maybe an ant/hudson example would be possible here?}

\index{API!bindings!Java}

\subsection{Perl Bindings}

\todo{For Perl, maybe give an example of the xml exporter}

\index{API!bindings!Perl}

\subsection{PHP bindings}

\index{API!bindings!PHP}

\subsection{Python Bindings}

\todo{For Python, maybe give an example of Deputy code}

\index{API!bindings!Python}

\subsubsection{Installation}

\subsubsection{Initialization}

Synopsis:

\begin{python}[]
    def __init__(self, root=None, loadpath=None, flags=NONE)
\end{python}

Initialize the library.

Use \verb!root! as the filesystem root. If \verb!root! is None, use the value of the environment variable AUGEAS\_ROOT. If that doesn't exist either, use \nolinkurl{/}.

\verb!loadpath! is a colon-spearated list of directories that modules should be searched in. This is in addition to the standard load path and the directories in \verb!AUGEAS_LENS_LIB!.

\verb!flags! is a bitmask made up of values from \verb!AUG_FLAGS!.

Example:

\begin{python}[]
    import augeas
    a = augeas.Augeas(root="fakeroot")
\end{python}

\subsubsection{The get method}

Synopsis:

\begin{python}[]
    def get(self, path)
\end{python}

Lookup the value associated with \verb!path!. Returns the value at the path specified. It is an error if more than one node matches \verb!path!.

Example:

\begin{python}[]
    val = a.get("/files/etc/ftab/1/canonical")
\end{python}

\subsection{Ruby Bindings}

\todo{Maybe redefining a native Puppet type in Ruby could be a nice example here}

\index{API!bindings!Ruby}

\index{API!bindings|)}

\index{API|)}


